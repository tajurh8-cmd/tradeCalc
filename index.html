<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Futures Risk Calculator (1% Fixed Risk)</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#111">Futures Risk Calculator (1% Fixed Risk)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body{background:#111;color:#fff}
.card{background:#1c1c1c;border:none}
.form-label{font-size:12px;color:#bbb}
.btn-gold{background:#c9a227;color:#000;font-weight:bold}
.result{color:#ddd}
.result b{float:right;color:#fff;font-size:14px;font-weight:700}
.result div{padding:6px 8px;background:#222;border-radius:6px;margin-bottom:6px}
</style>
</head>
<body>
<div class="container py-4">
  <div class="row justify-content-center">
    <div class="col-12 col-md-6 col-lg-4">
      <div class="card p-3 rounded-4">
        <h5 class="mb-3 text-white fw-bold">Risk Calculator (Fixed %)</h5>

        <div class="mb-2">
          <label class="form-label">Modal (USDT)</label>
          <input id="modal" type="number" class="form-control form-control-sm">
        </div>

        <div class="mb-2">
          <label class="form-label">Risk (%)</label>
          <input id="risk" type="number" class="form-control form-control-sm" value="1">
        </div>

        <div class="mb-2">
          <label class="form-label">Posisi</label>
          <select id="side" class="form-select form-select-sm">
            <option value="long">Long</option>
            <option value="short">Short</option>
          </select>
        </div>

        <div class="mb-2">
          <label class="form-label">Leverage (x)</label>
          <input id="lev" type="number" class="form-control form-control-sm" value="20">
        </div>

        <div class="mb-2">
          <label class="form-label">Harga Entry</label>
          <input id="entry" type="number" step="0.0001" class="form-control form-control-sm">
        </div>

        <div class="mb-3">
          <label class="form-label">Harga Stop Loss</label>
          <input id="sl" type="number" step="0.0001" class="form-control form-control-sm">
        </div>

        <button class="btn btn-gold w-100" onclick="hitung()">HITUNG</button>

        <div id="hasil" class="result mt-3 small"></div>
      </div>
    </div>
  </div>
</div>

<script>
// TUJUAN:
// Menentukan berapa USDT posisi agar loss tetap = X% modal
// Analogi: mau jatuh sejauh apa pun, dompet bocor tetap sama
function hitung(){
  const modal = +modalEl.value;
  const riskP = +riskEl.value / 100;
  const lev   = +levEl.value;
  const entry = +entryEl.value;
  const sl    = +slEl.value;
  const side  = sideEl.value;

  if(!modal || !entry || !sl || entry === sl || !lev){
    hasil.innerHTML = 'Input tidak valid';
    return;
  }

  const riskUSDT = modal * riskP;
  const diff = Math.abs(entry - sl) / entry;
  const diffPercent = diff * 100;

  const position = riskUSDT / diff;
  const margin = position / lev;

  let tp15, tp2;
  if(side === 'long'){
    tp15 = entry * (1 + diff * 1.5);
    tp2  = entry * (1 + diff * 2);
  } else {
    tp15 = entry * (1 - diff * 1.5);
    tp2  = entry * (1 - diff * 2);
  }

  hasil.innerHTML = `
    <div>Jarak Entry → SL <b>${diffPercent.toFixed(2)} %</b></div>
    <div>Risk Maksimal <b>${riskUSDT.toFixed(2)} USDT</b></div>
    <div>Position Size <b>${position.toFixed(2)} USDT</b></div>
    <div>Margin Terpakai <b>${margin.toFixed(2)} USDT</b></div>
    <div>Saran TP 1.5R <b>${tp15.toFixed(4)}</b></div>
    <div>Saran TP 2R <b>${tp2.toFixed(4)}</b></div>
  `;
}

  const riskUSDT = modal * riskP; // loss maksimal
  const diff = Math.abs(entry - sl) / entry;
  const diffPercent = diff * 100; // jarak entry ke SL (%) // % gerak harga

  // Position size agar loss = riskUSDT
  const position = riskUSDT / diff;
  const margin = position / lev;

  // TP otomatis berdasarkan posisi
  let tp15, tp2;
  if(side === 'long'){
    tp15 = entry * (1 + diff * 1.5);
    tp2  = entry * (1 + diff * 2);
  } else {
    tp15 = entry * (1 - diff * 1.5);
    tp2  = entry * (1 - diff * 2);
  }

  // TP suggestion based on SL distance
  const tp15 = entry * (1 + (diff * 1.5));
  const tp2  = entry * (1 + (diff * 2));

  hasil.innerHTML = `
        <div>Jarak Entry → SL <b>${diffPercent.toFixed(2)} %</b></div>
    <div>Risk Maksimal <b>${riskUSDT.toFixed(2)} USDT</b></div>
    <div>Position Size <b>${position.toFixed(2)} USDT</b></div>
        <div>Margin Terpakai <b>${margin.toFixed(2)} USDT</b></div>
    <div>Saran TP 1.5R <b>${tp15.toFixed(4)}</b></div>
    <div>Saran TP 2R <b>${tp2.toFixed(4)}</b></div>
  `;
}

const modalEl=document.getElementById('modal');
const riskEl=document.getElementById('risk');
const sideEl=document.getElementById('side');
const levEl=document.getElementById('lev');
const entryEl=document.getElementById('entry');
const slEl=document.getElementById('sl');
const hasil=document.getElementById('hasil');
</script>
<script>
// PWA: register service worker
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js');
}
</script>
</body>
</html>
